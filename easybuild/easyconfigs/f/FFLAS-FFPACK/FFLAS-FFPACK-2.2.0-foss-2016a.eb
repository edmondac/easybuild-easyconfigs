##
# This file is an EasyBuild recipe; see https://github.com/hpcugent/easybuild
#
# Copyright:: Copyright (c) 2016 Riccardo Murri <riccardo.murri@gmail.com>
# Authors::   Riccardo Murri <riccardo.murri@gmail.com>
# License::   GPL
#
##

easyblock = 'ConfigureMake'

name = 'FFLAS-FFPACK'
version = '2.2.0'

homepage = 'https://linbox-team.github.io/fflas-ffpack/'
description = "Finite Field Linear Algebra Subroutines / Package"

toolchain = {'version': '2016a', 'name': 'foss'}

sources = ['v2.2.0.zip']
source_urls = ['https://github.com/linbox-team/%(namelower)s/archive']

builddependencies = [
    ('Autoconf', '2.69', '', True),
    ('Automake', '1.15', '', True),
    ('libtool', '2.4.6', '', True),
]
dependencies = [
    ('GMP', '6.1.0', '', ('GCC', '4.9.3-2.25')),
    ('Givaro', '4.0.1'),
]

preconfigopts = "env NOCONFIGURE=1 ./autogen.sh && "
configopts = '--with-gmp=$EBROOTGMP --with-givaro=$EBROOTGIVARO --with-blas-cflags="-I$BLAS_INC_DIR" --with-blas-libs="-L$BLAS_LIB_DIR $LIBBLAS" --enable-openmp'

parallel = 4

unwanted_env_vars = {}
start_dir = '%(builddir)s/%(namelower)s-%(version)s/'

sanity_check_paths = {
    'files': ['bin/%(namelower)s-config', 'include/%(namelower)s/%(namelower)s.h'],
    'dirs': ['bin', 'include', 'lib'],
}

moduleclass = 'math'
# Build statistics
buildstats = [{
    "easybuild-framework_version": "2.8.0dev0",
    "easybuild-easyblocks_version": "2.8.0dev0",
    "timestamp": 1459270041,
    "build_time": 30.84,
    "install_size": 1762928,
    "command_line": ['--add-dummy-to-minimal-toolchains', '--buildpath=/tmp', '--experimental', '--github-user=riccardomurri', '--installpath=/home/rmurri/w/easybuild', '--minimal-toolchains', '--module-syntax=Lua', '--modules-tool=Lmod', '--packagepath=/home/rmurri/w/easybuild/packages', '--prefix=/home/rmurri/w/easybuild', '--repositorypath=ebfiles', '--robot=/home/rmurri/w/easybuild/ebfiles:/home/rmurri/w/easybuild/easyconfigs/easybuild/easyconfigs/', '--robot-paths=/home/rmurri/w/easybuild/ebfiles:/home/rmurri/w/easybuild/easyconfigs/easybuild/easyconfigs/', '--skip-test-cases', '--sourcepath=/home/rmurri/w/easybuild/sources', '--try-toolchain="[\'foss\', \'2016a\']"', 'FFLAS-FFPACK-2.2.0-foss-2015a.eb'],
    "modules_tool": ('Lmod', '/usr/share/lmod/lmod/libexec/lmod', '5.8'),
    "core_count": 4,
    "cpu_model": "Intel(R) Core(TM) i5 CPU       M 520  @ 2.40GHz",
    "cpu_speed": 2400.0,
    "cpu_vendor": "Intel",
    "gcc_version": "Using built-in specs.; COLLECT_GCC=gcc; COLLECT_LTO_WRAPPER=/home/rmurri/w/easybuild/software/GCCcore/4.9.3/libexec/gcc/x86_64-unknown-linux-gnu/4.9.3/lto-wrapper; Target: x86_64-unknown-linux-gnu; Configured with: ../configure --enable-languages=c,c++,fortran --enable-lto --enable-checking=release --disable-multilib --enable-shared=yes --enable-static=yes --enable-threads=posix --enable-gold=default --enable-plugins --enable-ld --with-plugin-ld=ld.gold --enable-bootstrap --prefix=/home/rmurri/w/easybuild/software/GCCcore/4.9.3 --with-local-prefix=/home/rmurri/w/easybuild/software/GCCcore/4.9.3; Thread model: posix; gcc version 4.9.3 (GCC) ; ",
    "glibc_version": "2.21",
    "hostname": "xenia",
    "os_name": "ubuntu",
    "os_type": "Linux",
    "os_version": "15.10",
    "platform_name": "x86_64-unknown-linux",
    "python_version": "2.7.10 (default, Oct 14 2015, 16:09:02) ; [GCC 5.2.1 20151010]",
    "system_gcc_path": "/home/rmurri/w/easybuild/software/GCCcore/4.9.3/bin/gcc",
    "system_python_path": "/home/rmurri/.virtualenvs/easybuild/bin/python",
}]
