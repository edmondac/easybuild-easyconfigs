easyblock = 'PythonPackage'

name = 'tvb-framework'
version = '20150921'
commit = '7e49b60'
versionsuffix = '-Python-%(pyver)s'

homepage = 'http://www.thevirtualbrain.org/'
description = """The Virtual Brain Project (TVB Project) has the purpose of offering some modern tools to the
 Neurosciences community, for computing, simulating and analyzing functional and structural data of human brains.
 TVB Scientific Library is the most important scientific contribution of TVB Project."""

toolchain = {'name': 'intel', 'version': '2016a'}

source_urls = ['https://github.com/the-virtual-brain/tvb-framework/archive/']
sources = ['%s.tar.gz' % commit]

patches = ['tvb-framework-%(version)s_no-fixed-matplotlib.patch']

freetype_ver = '2.6.3'
dependencies = [
    ('Python', '2.7.11'),  # provides numpy, Cython
    ('networkx', '1.11', versionsuffix),
    ('numexpr', '2.6.0', versionsuffix),
    ('gdist', '1.0.3', versionsuffix),
    ('NiBabel', '2.0.2', versionsuffix + '-freetype-%s' % freetype_ver),
    ('scikit-learn', '0.17.1', versionsuffix + '-freetype-%s' % freetype_ver),
    ('matplotlib', '1.5.1', versionsuffix + '-freetype-%s' % freetype_ver),
    ('lxml', '3.6.0', versionsuffix),
    ('h5py', '2.6.0', versionsuffix),
    ('psutil', '4.3.0', versionsuffix),
]

buildininstalldir = True
use_setup_py_develop = True

options = {'modulename': 'tvb.core'}

sanity_check_paths = {
    'files': ['tvb-framework-%s/tvb/config/logger/logger_config.conf' % commit],
    'dirs': ['lib/python%(pyshortver)s/site-packages'],
}

moduleclass = 'lib'
