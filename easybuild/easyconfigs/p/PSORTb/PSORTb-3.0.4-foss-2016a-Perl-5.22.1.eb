easyblock = 'PerlModule'

name = 'PSORTb'
version = '3.0.4'

homepage = 'http://psort.org/psortb/index.html'
description = """PSORTb v3.0.4 is the most precise bacterial localization prediction tool available."""

toolchain = {'name': 'foss', 'version': '2016a'}

source_urls = ['http://www.psort.org/download/']
sources = ['bio-tools-psort-all.%(version)s.tar.gz']

patches = ['PSORTb-3.03-libpsortb.patch']

perl = 'Perl'
perlver = '5.22.1'
versionsuffix = '-%s-%s' % (perl, perlver)

dependencies = [
    (perl, perlver),
    ('libpsortb','1.0'),
    ('BioPerl','1.6.924','-Perl-5.22.1'),
    ('BLAST+','2.3.0', '-Python-2.7.11'),
    ('pftools','2.3'),
]

options = {'modulename': 'Bio::Tools::PSort'}

preconfigopts = "export PSORTROOT=%(installdir)s && "

postinstallcmds = [
   "cp -r psort/* %(installdir)s/.",
]

perlmajver = perlver.split('.')[0]
sanity_check_paths = {
    'files': ['lib/perl%s/site_perl/%s/x86_64-linux-thread-multi/Algorithm/HMM.pm' % (perlmajver, perlver),
              'lib/perl%s/site_perl/%s/x86_64-linux-thread-multi/Bio/Tools/PSort.pm' % (perlmajver, perlver)],
    'dirs': ['lib/perl%s/site_perl/%s/x86_64-linux-thread-multi/Algorithm/HMM' % (perlmajver, perlver),
             'lib/perl%s/site_perl/%s/x86_64-linux-thread-multi/Bio/Tools/PSort' % (perlmajver, perlver)],
}

moduleclass = 'bio'
